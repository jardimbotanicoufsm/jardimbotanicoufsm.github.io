"use strict";(globalThis["webpackChunkjardim_botanico"]=globalThis["webpackChunkjardim_botanico"]||[]).push([[178],{1629:(t,i,e)=>{e.d(i,{D:()=>n});e(9665);var a=e(1809),o=e(3340),r=e(7524);const s=r.Z.create({baseURL:"https://api.example.com"}),l=((0,o.xr)((({app:t})=>{t.config.globalProperties.$axios=r.Z,t.config.globalProperties.$api=s})),(0,a.Q_)("googleApi",{state:()=>({spreadsheetId:"15pkvRPsPOIQJEe2hKn9XCHuKHQ5buoL2QiQnRJHu4yI",apiKey:"AIzaSyA_LT1DlQ_iArm1fGqxIK-YpjAOUSoZgZo"}),getters:{},actions:{}})),n=(0,a.Q_)("arrays",{state:()=>({pointsOfInterest:[],pointsOfInterestLoaded:!1,collection:[],collectionLoaded:!1,hikingTrails:[],hikingTrailsLoaded:!1,googleApi:l()}),getters:{},actions:{addToPointsOfInterest(t){this.pointsOfInterest.push(t)},addToCollection(t){this.collection.push(t)},addToHikingTrails(t){this.hikingTrails.push(t)},async loadPointsOfInterest(){if(!0===this.pointsOfInterestLoaded)return;const t=await this.readSheet("pontos_interesse");this.handlePointOfInterestSpreadsheetData(t),this.pointsOfInterestLoaded=!0},async loadCollection(){if(!0===this.collectionLoaded)return;const t=await this.readSheet("acervo");this.handleCollectionSpreadsheetData(t),this.collectionLoaded=!0},async loadHikingTrails(){if(!0===this.hikingTrailsLoaded)return;const t=await this.readSheet("trilhas");this.handleHikingTrailsSpreadsheetData(t),this.hikingTrailsLoaded=!0},async loadHikingTrailPoints(t){if(null==t)return;var i=this.hikingTrails.find((i=>i.id===t));if(null==i||!0===i.pointsLoaded)return;const e=await this.readSheet("pontos_trilha");this.handleHikingTrailPointsSpreadsheetData(i,e),i.pointsLoaded=!0},async readSheet(t){const i=`https://sheets.googleapis.com/v4/spreadsheets/${this.googleApi.spreadsheetId}/values/${t}?key=${this.googleApi.apiKey}`,e=await s.get(i);return e.data&&e.data.values?e.data.values:[]},handlePointOfInterestSpreadsheetData(t){const i=t[0],e=t.slice(1);e.forEach((t=>{const e={};t.forEach(((t,a)=>{e[i[a]]=t})),null!=e.id&&null!=e.categoria&&null!=e.nome&&null!=e.latitude&&null!=e.longitude&&(e.links=this.handleLinks(e.generic_links,e.drive_links),this.addToPointsOfInterest(e))}))},handleCollectionSpreadsheetData(t){const i=t[0],e=t.slice(1);e.forEach((t=>{const e={};t.forEach(((t,a)=>{e[i[a]]=t})),null!=e.id&&null!=e.nome&&(e.links=this.handleLinks(e.generic_links,e.drive_links),this.addToCollection(e))}))},handleHikingTrailsSpreadsheetData(t){const i=t[0],e=t.slice(1);e.forEach((t=>{const e={};t.forEach(((t,a)=>{e[i[a]]=t})),null!=e.id&&null!=e.nome&&(e.pointsLoaded=!1,e.points=[],this.addToHikingTrails(e))}))},handleHikingTrailPointsSpreadsheetData(t,i){const e=i[0],a=i.slice(1);a.forEach((i=>{const a={};i.forEach(((t,i)=>{a[e[i]]=t})),[a.trilha_id,a.latitude,a.longitude,a.ordem].some((t=>null==t))||a.trilha_id==t.id&&t.points.push(a)})),t.points.sort(((t,i)=>t.ordem-i.ordem))},handleLinks(t,i){if(null==t&&null==i)return null;let e=[];return null!=t&&t.split(";").forEach((t=>{e.push(t.trim())})),null!=i&&i.split(";").forEach((t=>{let i=t.split("/")[5];e.push("https://lh3.googleusercontent.com/d/"+i)})),e}}})},4361:(t,i,e)=>{e.d(i,{Z:()=>m});e(9665);var a=e(9835),o=e(6970);const r=(0,a._)("div",{id:"map"},null,-1);function s(t,i,e,s,l,n){const c=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),h=(0,a.up)("q-page-sticky");return(0,a.wg)(),(0,a.iD)(a.HY,null,[r,(0,a.Wm)(h,{position:"top-right",offset:[20,20]},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:(0,o.C_)(t.activeFilter==t.categories.Acervo.name?"q-btn--push":""),fab:"",icon:"ion-leaf",color:"green",onClick:i[0]||(i[0]=i=>t.filterMarkers("Acervo"))},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Acervo")])),_:1})])),_:1},8,["class"])])),_:1}),(0,a.Wm)(h,{position:"top-right",offset:[20,90]},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:(0,o.C_)(t.activeFilter==t.categories.Utilidade.name?"q-btn--push":""),fab:"",icon:"ion-home",color:"red",onClick:i[1]||(i[1]=i=>t.filterMarkers("Utilidade"))},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Utilidades")])),_:1})])),_:1},8,["class"])])),_:1}),(0,a.Wm)(h,{position:"top-right",offset:[20,160]},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:(0,o.C_)(t.activeFilter==t.categories.Atrativo.name?"q-btn--push":""),fab:"",icon:"ion-flower",color:"orange",onClick:i[2]||(i[2]=i=>t.filterMarkers("Atrativo"))},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Atrativos")])),_:1})])),_:1},8,["class"])])),_:1}),null!=t.activeFilter?((0,a.wg)(),(0,a.j4)(h,{key:0,position:"top-right",offset:[20,230]},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{fab:"",icon:"ion-close",color:"grey",onClick:i[3]||(i[3]=i=>t.filterMarkers(null))},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Limpar filtros")])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0),null==t.hikingTrailId?((0,a.wg)(),(0,a.j4)(h,{key:1,position:"bottom-left",offset:[20,20]},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{fab:"",icon:"ion-walk",color:"grey",onClick:i[4]||(i[4]=t=>{this.$router.push("/hikingTrails")})})])),_:1})):(0,a.kq)("",!0),null!=t.hikingTrailId?((0,a.wg)(),(0,a.j4)(h,{key:2,position:"bottom-left",offset:[20,20]},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{fab:"",icon:"ion-arrow-round-back",color:"grey",onClick:i[5]||(i[5]=t=>{this.$router.push("/")})})])),_:1})):(0,a.kq)("",!0)],64)}var l=e(4587),n=(e(4967),e(1629));const c=(0,a.aZ)({name:"LeafletMap",data(){return{activeFilter:null,map:null,categories:{Utilidade:{name:"Utilidade",color:"red"},Atrativo:{name:"Atrativo",color:"orange"},Acervo:{name:"Acervo",color:"green"}},arrays:(0,n.D)(),hikingTrailId:this.$route.params.hikingTrailId}},mounted(){this.createMap(),this.initiateMarkers(),this.initiateHikingTrail()},methods:{async initiateMarkers(){try{await this.arrays.loadPointsOfInterest(),await this.arrays.loadCollection(),this.arrays.pointsOfInterest.forEach((t=>{t.marker=this.createMarker(this.categories[t.categoria].color,t.latitude,t.longitude,t.nome,t.descricao,t.links)})),this.arrays.collection.filter((t=>null!=t.latitude&&null!=t.longitude)).forEach((t=>{t.marker=this.createMarker(this.categories["Acervo"].color,t.latitude,t.longitude,t.nome,"Outros nomes: "+t.outros_nomes+"<br>Classificação: "+t.classificacao+"<br>Origem: "+t.origem,t.links)})),this.filterMarkers(null)}catch(t){this.handleReadError(t,3)}},handleReadError(t,i){this.$q.notify({color:"negative",position:"bottom",message:`Impossível carregar dados (${i}): ${t.message}`,icon:"report_problem"})},createMap(){var t=l.map("map",{center:[-29.7194,-53.7295],zoom:17});l.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(t),l.control.locate({locateOptions:{enableHighAccuracy:!0}}).addTo(t),this.map=t},createMarker(t,i,e,a,o,r){const s=new l.Icon({iconUrl:`assets/img/marker-icon-2x-${t}.png`,shadowUrl:"assets/img/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),n=l.marker([i,e],{title:a,icon:s});let c="";null!=a&&(c=`<b>${a}</b><br>`);let d="";null!=o&&(d=`${o}<br>`);let h="";return null!=r&&r.forEach((t=>{h+=`<img src="${t}" width="100%">`})),n.bindPopup(`${c}${d}${h}`).openPopup(),n},displayPoiMarkers(t){this.arrays.pointsOfInterest.filter((i=>null!=i.marker&&i.categoria==t)).forEach((t=>t.marker.addTo(this.map)))},displayCollectionMarkers(){this.arrays.collection.filter((t=>null!=t.marker)).forEach((t=>t.marker.addTo(this.map)))},async initiateHikingTrail(){if(null!=this.hikingTrailId)try{await this.arrays.loadHikingTrails(),await this.arrays.loadHikingTrailPoints(this.hikingTrailId);var t=this.arrays.hikingTrails.find((t=>t.id===this.hikingTrailId));if(null!=t&&null!=t.points&&t.points.length>0){var i=l.polyline(t.points.map((t=>[t.latitude,t.longitude])),{color:"red"}).addTo(this.map);this.map.fitBounds(i.getBounds())}}catch(e){this.handleReadError(e,4)}},filterMarkers(t){this.activeFilter=t,this.hideMarkers(),null!=t?"Acervo"===t?this.displayCollectionMarkers():this.displayPoiMarkers(t):(this.displayPoiMarkers("Atrativo"),this.displayPoiMarkers("Utilidade"),this.displayCollectionMarkers())},hideMarkers(){this.arrays.pointsOfInterest.filter((t=>null!=t.marker)).forEach((t=>t.marker.remove())),this.arrays.collection.filter((t=>null!=t.marker)).forEach((t=>t.marker.remove()))}}});var d=e(1639),h=e(627),p=e(9379),u=e(2374),f=e(9984),g=e.n(f);const k=(0,d.Z)(c,[["render",s]]),m=k;g()(c,"components",{QPageSticky:h.Z,QBtn:p.Z,QTooltip:u.Z})},6178:(t,i,e)=>{e.r(i),e.d(i,{default:()=>p});var a=e(9835);function o(t,i,e,o,r,s){const l=(0,a.up)("LeafletMap"),n=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(n,{class:"flex flex-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(l)])),_:1})}var r=e(4361);const s=(0,a.aZ)({name:"HikingTrailPage",components:{LeafletMap:r.Z}});var l=e(1639),n=e(9885),c=e(9984),d=e.n(c);const h=(0,l.Z)(s,[["render",o]]),p=h;d()(s,"components",{QPage:n.Z})}}]);